{"version":3,"file":"mint-shared-metadata-function.test.js","names":["mintSharedMetadataFunction","mintToken","MOCK_CLIENT","MOCK_META_DATA","MOCK_TOKEN_ID","MOCK_SUPPLY_KEY","dictionary","jest","mock","fn","amount","Promise","resolve","serials","Array","from","length","_","i","beforeEach","resetAllMocks","describe","it","mockResolvedValueOnce","toNumber","result","client","metaData","tokenId","supplyKey","batchSize","expect","toHaveLength","toEqual","arrayContaining","content","serialNumber","calls","toBe","Math","ceil","rejects","toThrow","hederaActions","minBatchSize","maxBatchSize","metadataRequired","cannotParseTokenId"],"sources":["../../../../../src/test/unit/minting/mint-shared-metadata-function.test.ts"],"sourcesContent":["/*-\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2024 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { mintSharedMetadataFunction } from '../../../nftSDKFunctions/mint-shared-metadata-function';\nimport { mintToken } from '../../../nftSDKFunctions/mint-token';\nimport { MOCK_CLIENT, MOCK_META_DATA, MOCK_TOKEN_ID, MOCK_SUPPLY_KEY } from '../../__mocks__/consts';\nimport { dictionary } from '../../../utils/constants/dictionary';\n\njest.mock('../../../nftSDKFunctions/mint-token', () => ({\n  mintToken: jest.fn((amount) => {\n    return Promise.resolve({\n      serials: Array.from({ length: amount }, (_, i) => i + 1),\n    });\n  }),\n}));\n\nbeforeEach(() => {\n  jest.resetAllMocks();\n});\n\ndescribe('mintSharedMetadataFunction', () => {\n  it('should return correct metadata', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 10 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n\n    const result = await mintSharedMetadataFunction({\n      client: MOCK_CLIENT,\n      metaData: MOCK_META_DATA,\n      tokenId: MOCK_TOKEN_ID,\n      supplyKey: MOCK_SUPPLY_KEY,\n      amount: 10,\n      batchSize: 2,\n    });\n\n    expect(result).toHaveLength(10);\n    expect(result).toEqual(expect.arrayContaining([{ content: MOCK_META_DATA, serialNumber: 1 }]));\n    expect((mintToken as jest.Mock).mock.calls.length).toBe(Math.ceil(10 / 2));\n  });\n\n  it('should handle amount less than batchSize correctly', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 1 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n\n    const result = await mintSharedMetadataFunction({\n      client: MOCK_CLIENT,\n      metaData: MOCK_META_DATA,\n      tokenId: MOCK_TOKEN_ID,\n      supplyKey: MOCK_SUPPLY_KEY,\n      amount: 1,\n      batchSize: 2,\n    });\n\n    expect(result).toEqual(expect.arrayContaining([{ content: MOCK_META_DATA, serialNumber: 1 }]));\n    expect((mintToken as jest.Mock).mock.calls.length).toBe(Math.ceil(1 / 2));\n  });\n\n  it('should handle batchSize of 1 correctly', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 1 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n\n    const result = await mintSharedMetadataFunction({\n      client: MOCK_CLIENT,\n      metaData: MOCK_META_DATA,\n      tokenId: MOCK_TOKEN_ID,\n      supplyKey: MOCK_SUPPLY_KEY,\n      amount: 1,\n      batchSize: 1,\n    });\n\n    expect(result).toEqual(expect.arrayContaining([{ content: MOCK_META_DATA, serialNumber: 1 }]));\n    expect((mintToken as jest.Mock).mock.calls.length).toBe(Math.ceil(1 / 1));\n  });\n\n  it('should handle batchSize of 10 correctly', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 10 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n\n    const result = await mintSharedMetadataFunction({\n      client: MOCK_CLIENT,\n      metaData: MOCK_META_DATA,\n      tokenId: MOCK_TOKEN_ID,\n      supplyKey: MOCK_SUPPLY_KEY,\n      amount: 10,\n      batchSize: 10,\n    });\n    expect(result).toHaveLength(10);\n    expect(result).toEqual(expect.arrayContaining([{ content: MOCK_META_DATA, serialNumber: 1 }]));\n    expect((mintToken as jest.Mock).mock.calls.length).toBe(Math.ceil(10 / 10));\n  });\n\n  it('should handle error when batchSize is lower than 1', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 1 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n    await expect(\n      mintSharedMetadataFunction({\n        client: MOCK_CLIENT,\n        metaData: MOCK_META_DATA,\n        tokenId: MOCK_TOKEN_ID,\n        supplyKey: MOCK_SUPPLY_KEY,\n        amount: 1,\n        batchSize: -1,\n      })\n    ).rejects.toThrow(dictionary.hederaActions.minBatchSize);\n  });\n\n  it('should handle error when batchSize is higher than 10', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 1 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n\n    await expect(\n      mintSharedMetadataFunction({\n        client: MOCK_CLIENT,\n        metaData: MOCK_META_DATA,\n        tokenId: MOCK_TOKEN_ID,\n        supplyKey: MOCK_SUPPLY_KEY,\n        amount: 1,\n        batchSize: 11,\n      })\n    ).rejects.toThrow(dictionary.hederaActions.maxBatchSize);\n  });\n\n  it('should handle error when metaData is not passed', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 1 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n    await expect(\n      mintSharedMetadataFunction({\n        client: MOCK_CLIENT,\n        metaData: '',\n        tokenId: MOCK_TOKEN_ID,\n        supplyKey: MOCK_SUPPLY_KEY,\n        amount: 1,\n        batchSize: 10,\n      })\n    ).rejects.toThrow(dictionary.hederaActions.metadataRequired);\n  });\n\n  it('should handle error when tokenId is not passed', async () => {\n    (mintToken as jest.Mock).mockResolvedValueOnce({\n      serials: Array.from({ length: 1 }, (_, i) => ({\n        toNumber: () => i + 1,\n      })),\n    });\n    await expect(\n      mintSharedMetadataFunction({\n        client: MOCK_CLIENT,\n        metaData: MOCK_META_DATA,\n        tokenId: '',\n        supplyKey: MOCK_SUPPLY_KEY,\n        amount: 1,\n        batchSize: 10,\n      })\n    ).rejects.toThrow(dictionary.hederaActions.cannotParseTokenId);\n  });\n});\n"],"mappings":"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","ignoreList":[]}