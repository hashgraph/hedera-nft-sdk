{"version":3,"file":"get-holder-and-duration.test.js","names":["axios","dictionary","MOCK_SERIAL","MOCK_TOKEN_ID","NETWORK","getHolderAndDuration","jest","mock","describe","mockAxios","beforeEach","it","mockNFTDetails","deleted","mockTransactions","transactions","type","receiver_account_id","consensus_timestamp","links","next","get","mockImplementationOnce","Promise","resolve","data","result","tokenId","serialNumber","network","expect","toEqual","holder","holderSince","any","String","rejects","toThrow","errors","nftDeleted","nftNoTransactions"],"sources":["../../../../src/test/unit/get-holder-and-duration.test.ts"],"sourcesContent":["import axios from 'axios';\nimport { dictionary } from '../../utils/constants/dictionary';\nimport { MOCK_SERIAL, MOCK_TOKEN_ID, NETWORK } from '../__mocks__/consts';\nimport { getHolderAndDuration } from '../../get-holder-and-duration';\n\njest.mock('axios');\n\ndescribe('getHolderAndDuration', () => {\n  let mockAxios: jest.Mocked<typeof axios>;\n\n  beforeEach(() => {\n    mockAxios = axios as jest.Mocked<typeof axios>;\n  });\n\n  it('should return holder and duration', async () => {\n    const mockNFTDetails = { deleted: false };\n    const mockTransactions = {\n      transactions: [\n        {\n          type: 'CRYPTOTRANSFER',\n          receiver_account_id: 'mockReceiverAccountId',\n          consensus_timestamp: '1695821531.685486177',\n        },\n      ],\n      links: { next: null },\n    };\n\n    mockAxios.get.mockImplementationOnce(() => Promise.resolve({ data: mockNFTDetails }));\n    mockAxios.get.mockImplementationOnce(() => Promise.resolve({ data: mockTransactions }));\n\n    const result = await getHolderAndDuration({\n      tokenId: MOCK_TOKEN_ID,\n      serialNumber: MOCK_SERIAL,\n      network: NETWORK,\n    });\n\n    expect(result).toEqual({\n      holder: 'mockReceiverAccountId',\n      holderSince: expect.any(String),\n    });\n  });\n\n  it('should throw an error when the NFT has been deleted', async () => {\n    const mockNFTDetails = { deleted: true };\n\n    mockAxios.get.mockImplementationOnce(() => Promise.resolve({ data: mockNFTDetails }));\n\n    await expect(\n      getHolderAndDuration({\n        tokenId: MOCK_TOKEN_ID,\n        serialNumber: MOCK_SERIAL,\n        network: NETWORK,\n      })\n    ).rejects.toThrow(dictionary.errors.nftDeleted);\n  });\n\n  it('should throw an error when there are no transactions for the NFT', async () => {\n    const mockNFTDetails = { deleted: false };\n    const mockTransactions = { transactions: [], links: { next: null } };\n\n    mockAxios.get.mockImplementationOnce(() => Promise.resolve({ data: mockNFTDetails }));\n    mockAxios.get.mockImplementationOnce(() => Promise.resolve({ data: mockTransactions }));\n\n    await expect(\n      getHolderAndDuration({\n        tokenId: MOCK_TOKEN_ID,\n        serialNumber: MOCK_SERIAL,\n        network: NETWORK,\n      })\n    ).rejects.toThrow(dictionary.errors.nftNoTransactions);\n  });\n});\n"],"mappings":"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","ignoreList":[]}