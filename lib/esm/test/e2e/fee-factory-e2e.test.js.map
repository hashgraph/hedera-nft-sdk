{"version":3,"file":"fee-factory-e2e.test.js","names":["feeFactoryInstance","nftSDK","myAccountId","mySecondAccountId","CustomFixedFee","CustomRoyaltyFee","TokenInfoQuery","dictionary","describe","it","fixedFee","allCollectorsAreExempt","collectorAccountId","hbarAmount","tokenId","createCollection","collectionName","collectionSymbol","customFees","query","setTokenId","tokenInfo","execute","client","customFeeAccId","length","_feeCollectorAccountId","toString","expect","toEqual","toBeDefined","royaltyFee","numerator","denominator","fallbackFee","customFeeDenominator","undefined","customFeeNumenator","_denominator","toInt","_numerator","Number","amount","denominatingTokenId","rejects","toThrow","hederaActions","tooManyCustomFees"],"sources":["../../../../src/test/e2e/fee-factory-e2e.test.ts"],"sourcesContent":["/*-\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2024 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { feeFactoryInstance, nftSDK } from './e2e-consts';\nimport { myAccountId, mySecondAccountId } from '../__mocks__/consts';\nimport { CustomFixedFee, CustomRoyaltyFee, TokenInfoQuery } from '@hashgraph/sdk';\nimport { dictionary } from '../../utils/constants/dictionary';\n\ndescribe('feeFactory', () => {\n  it('creates a collection with fixedFee', async () => {\n    const fixedFee = feeFactoryInstance.fixedFee({\n      allCollectorsAreExempt: false,\n      collectorAccountId: myAccountId,\n      hbarAmount: 100,\n    });\n\n    const tokenId = await nftSDK.createCollection({\n      collectionName: 'test_name',\n      collectionSymbol: 'test_symbol',\n      customFees: [fixedFee],\n    });\n\n    const query = new TokenInfoQuery().setTokenId(tokenId);\n    const tokenInfo = await query.execute(nftSDK.client);\n    const customFees = tokenInfo.customFees;\n    let customFeeAccId = '';\n\n    if (customFees.length > 0 && customFees[0] instanceof CustomFixedFee) {\n      customFeeAccId = customFees[0]._feeCollectorAccountId!.toString();\n    }\n\n    expect(customFeeAccId).toEqual(myAccountId);\n    expect(tokenId).toBeDefined();\n  });\n\n  it('creates a collection with royaltyFee', async () => {\n    const royaltyFee = feeFactoryInstance.royaltyFee({\n      collectorAccountId: myAccountId,\n      numerator: 1,\n      denominator: 100,\n      allCollectorsAreExempt: false,\n      fallbackFee: {\n        allCollectorsAreExempt: false,\n        collectorAccountId: mySecondAccountId,\n        hbarAmount: 100,\n      },\n    });\n\n    const tokenId = await nftSDK.createCollection({\n      collectionName: 'test_name',\n      collectionSymbol: 'test_symbol',\n      customFees: [royaltyFee],\n    });\n\n    const query = new TokenInfoQuery().setTokenId(tokenId);\n    const tokenInfo = await query.execute(nftSDK.client);\n    const customFees = tokenInfo.customFees;\n    let customFeeDenominator = undefined;\n    let customFeeNumenator = undefined;\n\n    if (customFees.length > 0 && customFees[0] instanceof CustomRoyaltyFee) {\n      customFeeDenominator = customFees[0]._denominator.toInt();\n      customFeeNumenator = customFees[0]._numerator.toString();\n    }\n\n    expect(Number(customFeeNumenator)).toEqual(royaltyFee.numerator.toInt());\n    expect(customFeeDenominator).toEqual(royaltyFee.denominator.toInt());\n    expect(tokenId).toBeDefined();\n  });\n\n  it('creates a collection with royaltyFee and fixedFee', async () => {\n    const royaltyFee = feeFactoryInstance.royaltyFee({\n      collectorAccountId: myAccountId,\n      numerator: 1,\n      denominator: 100,\n      allCollectorsAreExempt: false,\n      fallbackFee: {\n        allCollectorsAreExempt: false,\n        collectorAccountId: mySecondAccountId,\n        hbarAmount: 100,\n      },\n    });\n\n    const fixedFee = feeFactoryInstance.fixedFee({\n      allCollectorsAreExempt: false,\n      collectorAccountId: myAccountId,\n      hbarAmount: 100,\n    });\n\n    const tokenId = await nftSDK.createCollection({\n      collectionName: 'test_name',\n      collectionSymbol: 'test_symbol',\n      customFees: [royaltyFee, fixedFee],\n    });\n\n    const query = new TokenInfoQuery().setTokenId(tokenId);\n    const tokenInfo = await query.execute(nftSDK.client);\n    const customFees = tokenInfo.customFees;\n    let customFeeDenominator = undefined;\n    let customFeeNumenator = undefined;\n\n    if (customFees.length > 0 && customFees[0] instanceof CustomRoyaltyFee) {\n      customFeeDenominator = customFees[0]._denominator.toInt();\n      customFeeNumenator = customFees[0]._numerator.toString();\n    }\n\n    expect(Number(customFeeNumenator)).toEqual(royaltyFee.numerator.toInt());\n    expect(customFeeDenominator).toEqual(royaltyFee.denominator.toInt());\n    expect(tokenId).toBeDefined();\n  });\n\n  it('throws error when more than 10 customFees', async () => {\n    const fixedFee = feeFactoryInstance.fixedFee({\n      allCollectorsAreExempt: false,\n      collectorAccountId: myAccountId,\n      amount: 100,\n      denominatingTokenId: myAccountId,\n    });\n\n    await expect(\n      nftSDK.createCollection({\n        collectionName: 'test_name',\n        collectionSymbol: 'test_symbol',\n        customFees: [fixedFee, fixedFee, fixedFee, fixedFee, fixedFee, fixedFee, fixedFee, fixedFee, fixedFee, fixedFee, fixedFee],\n      })\n    ).rejects.toThrow(dictionary.hederaActions.tooManyCustomFees);\n  });\n});\n"],"mappings":"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","ignoreList":[]}