{"version":3,"file":"index.js","names":["schemaValidator","attributesValidator","localizationValidator","SHA256Validator","token_metadata_1_0_0","token_metadata_2_0_0","defaultSchemaVersion","Validator","constructor","schemas","schemaMap","Map","set","forEach","schema","tag","schemaObject","getSchema","version","validVersion","has","get","validate","instance","schemaVersion","Error","schemaProblems","errors","length","warnings"],"sources":["../../../src/validator/index.ts"],"sourcesContent":["/*\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2023 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { schemaValidator, attributesValidator, localizationValidator, SHA256Validator } from './validators';\n\nimport token_metadata_1_0_0 from './schemas/HIP10@1.0.0';\nimport token_metadata_2_0_0 from './schemas/HIP412@2.0.0';\nconst defaultSchemaVersion = '2.0.0';\n\nimport { Schema, Instance } from '../types/validator';\n\nclass Validator {\n  private schemaMap: Map<string, Object>;\n\n  constructor(schemas: Schema[] = []) {\n    this.schemaMap = new Map();\n    this.schemaMap.set('1.0.0', token_metadata_1_0_0);\n    this.schemaMap.set('2.0.0', token_metadata_2_0_0);\n\n    schemas.forEach((schema) => {\n      this.schemaMap.set(schema.tag, schema.schemaObject);\n    });\n  }\n\n  getSchema(version: string) {\n    const validVersion = this.schemaMap.has(version);\n    if (validVersion) {\n      return this.schemaMap.get(version);\n    }\n\n    return this.schemaMap.get(defaultSchemaVersion);\n  }\n\n  validate(instance: Instance, schemaVersion: string = defaultSchemaVersion) {\n    const schema = this.getSchema(schemaVersion);\n    if (!schema) throw new Error('Invalid schema version');\n\n    const schemaProblems = schemaValidator(instance, schema);\n\n    // If there are schema problems, return them and stop the validation process\n    if (schemaProblems.errors.length > 0) {\n      return {\n        errors: [...schemaProblems.errors],\n        warnings: [...schemaProblems.warnings],\n      };\n    }\n\n    const errors = [...attributesValidator(instance), ...localizationValidator(instance), ...SHA256Validator(instance)];\n\n    return {\n      errors,\n      warnings: [...schemaProblems.warnings],\n    };\n  }\n}\n\nexport { Validator, defaultSchemaVersion };\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,eAAe,EAAEC,mBAAmB,EAAEC,qBAAqB,EAAEC,eAAe,QAAQ,cAAc;AAE3G,OAAOC,oBAAoB,MAAM,uBAAuB;AACxD,OAAOC,oBAAoB,MAAM,wBAAwB;AACzD,MAAMC,oBAAoB,GAAG,OAAO;AAIpC,MAAMC,SAAS,CAAC;EAGdC,WAAWA,CAACC,OAAiB,GAAG,EAAE,EAAE;IAClC,IAAI,CAACC,SAAS,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC1B,IAAI,CAACD,SAAS,CAACE,GAAG,CAAC,OAAO,EAAER,oBAAoB,CAAC;IACjD,IAAI,CAACM,SAAS,CAACE,GAAG,CAAC,OAAO,EAAEP,oBAAoB,CAAC;IAEjDI,OAAO,CAACI,OAAO,CAAEC,MAAM,IAAK;MAC1B,IAAI,CAACJ,SAAS,CAACE,GAAG,CAACE,MAAM,CAACC,GAAG,EAAED,MAAM,CAACE,YAAY,CAAC;IACrD,CAAC,CAAC;EACJ;EAEAC,SAASA,CAACC,OAAe,EAAE;IACzB,MAAMC,YAAY,GAAG,IAAI,CAACT,SAAS,CAACU,GAAG,CAACF,OAAO,CAAC;IAChD,IAAIC,YAAY,EAAE;MAChB,OAAO,IAAI,CAACT,SAAS,CAACW,GAAG,CAACH,OAAO,CAAC;IACpC;IAEA,OAAO,IAAI,CAACR,SAAS,CAACW,GAAG,CAACf,oBAAoB,CAAC;EACjD;EAEAgB,QAAQA,CAACC,QAAkB,EAAEC,aAAqB,GAAGlB,oBAAoB,EAAE;IACzE,MAAMQ,MAAM,GAAG,IAAI,CAACG,SAAS,CAACO,aAAa,CAAC;IAC5C,IAAI,CAACV,MAAM,EAAE,MAAM,IAAIW,KAAK,CAAC,wBAAwB,CAAC;IAEtD,MAAMC,cAAc,GAAG1B,eAAe,CAACuB,QAAQ,EAAET,MAAM,CAAC;;IAExD;IACA,IAAIY,cAAc,CAACC,MAAM,CAACC,MAAM,GAAG,CAAC,EAAE;MACpC,OAAO;QACLD,MAAM,EAAE,CAAC,GAAGD,cAAc,CAACC,MAAM,CAAC;QAClCE,QAAQ,EAAE,CAAC,GAAGH,cAAc,CAACG,QAAQ;MACvC,CAAC;IACH;IAEA,MAAMF,MAAM,GAAG,CAAC,GAAG1B,mBAAmB,CAACsB,QAAQ,CAAC,EAAE,GAAGrB,qBAAqB,CAACqB,QAAQ,CAAC,EAAE,GAAGpB,eAAe,CAACoB,QAAQ,CAAC,CAAC;IAEnH,OAAO;MACLI,MAAM;MACNE,QAAQ,EAAE,CAAC,GAAGH,cAAc,CAACG,QAAQ;IACvC,CAAC;EACH;AACF;AAEA,SAAStB,SAAS,EAAED,oBAAoB","ignoreList":[]}