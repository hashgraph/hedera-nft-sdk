{"version":3,"file":"localization.js","names":["dictionary","localizationValidator","instance","localization","errors","default","length","push","type","msg","defaultLocaleTwoLetterLanguageCode","notTwoLetterCode","locales","filter","locale","map","localeTwoLetterLanguageCode","includes","defaultLocaleShouldNotAppear","uri","wrongUriFormat"],"sources":["../../../../src/validator/validators/localization.ts"],"sourcesContent":["/*-\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2023 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { Instance, Error } from '../../types/validator';\nimport { dictionary } from '../../utils/constants/dictionary';\n\n/**\n * The localization validator applies specific rules for the localization object\n * such as validating two-letter language codes, the default locale, and the localization URI format.\n * If the localization field is not present (optional field), no errors are returned.\n *\n * @see https://github.com/hashgraph/hedera-improvement-proposal/blob/main/HIP/hip-412.md#localization\n *\n * @param {Object} instance - The JSON object to validate against a schema\n * @returns {Array} - Contains no, one, or multiple error objects that describe errors for the validated {instance}\n */\nconst localizationValidator = (instance: Instance) => {\n  const localization = instance.localization;\n  const errors: Error[] = [];\n\n  if (!localization) return errors; // localization is an optional field\n\n  if (localization.default.length != 2) {\n    // default should be two-letter language code\n    errors.push({\n      type: 'localization',\n      msg: `${dictionary.errors.localization.defaultLocaleTwoLetterLanguageCode}: ${localization.default}`,\n    });\n  }\n\n  // check for two-letter language codes in \"locales\"\n  const notTwoLetterCode = localization.locales.filter((locale) => locale.length != 2);\n  if (notTwoLetterCode.length > 0) {\n    notTwoLetterCode.map((locale) => {\n      errors.push({\n        type: 'localization',\n        msg: `${dictionary.errors.localization.localeTwoLetterLanguageCode}: ${locale}`,\n      });\n    });\n  }\n\n  if (localization.locales.includes(localization.default)) {\n    // default locale should not appear in locales array\n    errors.push({\n      type: 'localization',\n      msg: dictionary.errors.localization.defaultLocaleShouldNotAppear,\n    });\n  }\n\n  // localization.uri should follow format <protocol>://<hash>/{locale}.json (check for last part \"{locale}.json\")\n  if (!localization.uri.includes('/{locale}.json')) {\n    errors.push({\n      type: 'localization',\n      msg: dictionary.errors.localization.wrongUriFormat,\n    });\n  }\n\n  return errors;\n};\n\nexport { localizationValidator };\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASA,UAAU,QAAQ,kCAAkC;;AAE7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,qBAAqB,GAAIC,QAAkB,IAAK;EACpD,MAAMC,YAAY,GAAGD,QAAQ,CAACC,YAAY;EAC1C,MAAMC,MAAe,GAAG,EAAE;EAE1B,IAAI,CAACD,YAAY,EAAE,OAAOC,MAAM,CAAC,CAAC;;EAElC,IAAID,YAAY,CAACE,OAAO,CAACC,MAAM,IAAI,CAAC,EAAE;IACpC;IACAF,MAAM,CAACG,IAAI,CAAC;MACVC,IAAI,EAAE,cAAc;MACpBC,GAAG,EAAG,GAAET,UAAU,CAACI,MAAM,CAACD,YAAY,CAACO,kCAAmC,KAAIP,YAAY,CAACE,OAAQ;IACrG,CAAC,CAAC;EACJ;;EAEA;EACA,MAAMM,gBAAgB,GAAGR,YAAY,CAACS,OAAO,CAACC,MAAM,CAAEC,MAAM,IAAKA,MAAM,CAACR,MAAM,IAAI,CAAC,CAAC;EACpF,IAAIK,gBAAgB,CAACL,MAAM,GAAG,CAAC,EAAE;IAC/BK,gBAAgB,CAACI,GAAG,CAAED,MAAM,IAAK;MAC/BV,MAAM,CAACG,IAAI,CAAC;QACVC,IAAI,EAAE,cAAc;QACpBC,GAAG,EAAG,GAAET,UAAU,CAACI,MAAM,CAACD,YAAY,CAACa,2BAA4B,KAAIF,MAAO;MAChF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEA,IAAIX,YAAY,CAACS,OAAO,CAACK,QAAQ,CAACd,YAAY,CAACE,OAAO,CAAC,EAAE;IACvD;IACAD,MAAM,CAACG,IAAI,CAAC;MACVC,IAAI,EAAE,cAAc;MACpBC,GAAG,EAAET,UAAU,CAACI,MAAM,CAACD,YAAY,CAACe;IACtC,CAAC,CAAC;EACJ;;EAEA;EACA,IAAI,CAACf,YAAY,CAACgB,GAAG,CAACF,QAAQ,CAAC,gBAAgB,CAAC,EAAE;IAChDb,MAAM,CAACG,IAAI,CAAC;MACVC,IAAI,EAAE,cAAc;MACpBC,GAAG,EAAET,UAAU,CAACI,MAAM,CAACD,YAAY,CAACiB;IACtC,CAAC,CAAC;EACJ;EAEA,OAAOhB,MAAM;AACf,CAAC;AAED,SAASH,qBAAqB","ignoreList":[]}