{"version":3,"file":"index.js","names":["TokenMetadataValidator","dictionary","Hip412MetadataBuilder","constructor","metadataObject","name","image","type","format","setProperty","key","value","Error","errors","metadataBuilder","fieldAlreadySet","setName","setImage","setType","setCreator","creator","setCreatorDID","creatorDID","setDescription","description","setChecksum","checksum","addAttribute","trait_type","display_type","max_value","attribute","undefined","attributes","push","addFile","uri","is_default_file","metadata","metadata_uri","uriAndTypeRequired","file","files","addProperty","properties","setLocalization","default","defaultLocale","locales","localization","localizationAlreadySet","length","localizatonFieldsMissing","build","validationResult","validateSingleMetadataObject"],"sources":["../../../src/hip412-metadata-builder/index.ts"],"sourcesContent":["/*-\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2024 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { TokenMetadataValidator } from '../token-metadata-validator';\nimport { Attribute, FileMetadata, Localization, NFTMetadata } from '../types/nft-metadata';\nimport { FileValidationResult } from '../types/hip412-validator';\nimport { dictionary } from '../utils/constants/dictionary';\n\ninterface Hip412MetadataBuilderResult {\n  metadata: NFTMetadata;\n  validationResult: FileValidationResult;\n}\n\nexport class Hip412MetadataBuilder {\n  private metadataObject: NFTMetadata;\n\n  constructor() {\n    this.metadataObject = {\n      name: '',\n      image: '',\n      type: '',\n      format: 'HIP412@2.0.0',\n    };\n  }\n\n  private setProperty<T extends keyof NFTMetadata>(key: T, value: NFTMetadata[T]): Hip412MetadataBuilder {\n    if (this.metadataObject[key]) {\n      throw new Error(dictionary.errors.metadataBuilder.fieldAlreadySet(key));\n    }\n    this.metadataObject[key] = value;\n    return this;\n  }\n\n  setName(name: string): Hip412MetadataBuilder {\n    return this.setProperty('name', name);\n  }\n\n  setImage(image: string): Hip412MetadataBuilder {\n    return this.setProperty('image', image);\n  }\n\n  setType(type: string): Hip412MetadataBuilder {\n    return this.setProperty('type', type);\n  }\n\n  setCreator(creator: string): Hip412MetadataBuilder {\n    return this.setProperty('creator', creator);\n  }\n\n  setCreatorDID(creatorDID: string): Hip412MetadataBuilder {\n    return this.setProperty('creatorDID', creatorDID);\n  }\n\n  setDescription(description: string): Hip412MetadataBuilder {\n    return this.setProperty('description', description);\n  }\n\n  setChecksum(checksum: string): Hip412MetadataBuilder {\n    return this.setProperty('checksum', checksum);\n  }\n\n  addAttribute({ trait_type, value, display_type, max_value }: Attribute): Hip412MetadataBuilder {\n    const attribute: Attribute = {\n      trait_type,\n      value,\n      ...(display_type && { display_type }),\n      ...(max_value !== undefined && { max_value }),\n    };\n\n    this.metadataObject.attributes = this.metadataObject.attributes || [];\n    this.metadataObject.attributes.push(attribute);\n    return this;\n  }\n\n  addFile({ uri, type, checksum, is_default_file, metadata, metadata_uri }: FileMetadata): Hip412MetadataBuilder {\n    if (!uri || !type) {\n      throw new Error(dictionary.errors.metadataBuilder.uriAndTypeRequired);\n    }\n\n    const file: FileMetadata = {\n      uri,\n      type,\n      ...(checksum && { checksum }),\n      ...(is_default_file !== undefined && { is_default_file }),\n      ...(metadata && { metadata }),\n      ...(metadata_uri && { metadata_uri }),\n    };\n\n    if (!this.metadataObject.files) {\n      this.metadataObject.files = [];\n    }\n\n    this.metadataObject.files.push(file);\n    return this;\n  }\n\n  addProperty({ key, value }: { key: string; value: string | number | boolean | object }): Hip412MetadataBuilder {\n    if (!this.metadataObject.properties) {\n      this.metadataObject.properties = {};\n    }\n\n    this.metadataObject.properties[key] = value;\n    return this;\n  }\n\n  setLocalization({ uri, default: defaultLocale, locales }: Localization): Hip412MetadataBuilder {\n    if (this.metadataObject.localization) {\n      throw new Error(dictionary.errors.metadataBuilder.localizationAlreadySet);\n    }\n\n    if (!uri || !defaultLocale || !locales || locales.length === 0) {\n      throw new Error(dictionary.errors.metadataBuilder.localizatonFieldsMissing);\n    }\n\n    this.metadataObject.localization = {\n      uri,\n      default: defaultLocale,\n      locales,\n    };\n\n    return this;\n  }\n\n  build(): Hip412MetadataBuilderResult {\n    const validationResult = TokenMetadataValidator.validateSingleMetadataObject(this.metadataObject);\n    return { validationResult, metadata: this.metadataObject };\n  }\n}\n"],"mappings":"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","ignoreList":[]}