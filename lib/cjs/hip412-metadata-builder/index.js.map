{"version":3,"file":"index.js","names":["_tokenMetadataValidator","require","_dictionary","Hip412MetadataBuilder","constructor","metadataObject","name","image","type","format","setProperty","key","value","Error","dictionary","errors","metadataBuilder","fieldAlreadySet","setName","setImage","setType","setCreator","creator","setCreatorDID","creatorDID","setDescription","description","setChecksum","checksum","addAttribute","_ref","trait_type","display_type","max_value","attribute","undefined","attributes","push","addFile","_ref2","uri","is_default_file","metadata","metadata_uri","uriAndTypeRequired","file","files","addProperty","_ref3","properties","setLocalization","_ref4","default","defaultLocale","locales","localization","localizationAlreadySet","length","localizatonFieldsMissing","build","validationResult","TokenMetadataValidator","validateSingleMetadataObject","exports"],"sources":["../../../src/hip412-metadata-builder/index.ts"],"sourcesContent":["/*-\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2024 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { TokenMetadataValidator } from '../token-metadata-validator';\nimport { Attribute, FileMetadata, Localization, NFTMetadata } from '../types/nft-metadata';\nimport { FileValidationResult } from '../types/hip412-validator';\nimport { dictionary } from '../utils/constants/dictionary';\n\ninterface Hip412MetadataBuilderResult {\n  metadata: NFTMetadata;\n  validationResult: FileValidationResult;\n}\n\nexport class Hip412MetadataBuilder {\n  private metadataObject: NFTMetadata;\n\n  constructor() {\n    this.metadataObject = {\n      name: '',\n      image: '',\n      type: '',\n      format: 'HIP412@2.0.0',\n    };\n  }\n\n  private setProperty<T extends keyof NFTMetadata>(key: T, value: NFTMetadata[T]): Hip412MetadataBuilder {\n    if (this.metadataObject[key]) {\n      throw new Error(dictionary.errors.metadataBuilder.fieldAlreadySet(key));\n    }\n    this.metadataObject[key] = value;\n    return this;\n  }\n\n  setName(name: string): Hip412MetadataBuilder {\n    return this.setProperty('name', name);\n  }\n\n  setImage(image: string): Hip412MetadataBuilder {\n    return this.setProperty('image', image);\n  }\n\n  setType(type: string): Hip412MetadataBuilder {\n    return this.setProperty('type', type);\n  }\n\n  setCreator(creator: string): Hip412MetadataBuilder {\n    return this.setProperty('creator', creator);\n  }\n\n  setCreatorDID(creatorDID: string): Hip412MetadataBuilder {\n    return this.setProperty('creatorDID', creatorDID);\n  }\n\n  setDescription(description: string): Hip412MetadataBuilder {\n    return this.setProperty('description', description);\n  }\n\n  setChecksum(checksum: string): Hip412MetadataBuilder {\n    return this.setProperty('checksum', checksum);\n  }\n\n  addAttribute({ trait_type, value, display_type, max_value }: Attribute): Hip412MetadataBuilder {\n    const attribute: Attribute = {\n      trait_type,\n      value,\n      ...(display_type && { display_type }),\n      ...(max_value !== undefined && { max_value }),\n    };\n\n    this.metadataObject.attributes = this.metadataObject.attributes || [];\n    this.metadataObject.attributes.push(attribute);\n    return this;\n  }\n\n  addFile({ uri, type, checksum, is_default_file, metadata, metadata_uri }: FileMetadata): Hip412MetadataBuilder {\n    if (!uri || !type) {\n      throw new Error(dictionary.errors.metadataBuilder.uriAndTypeRequired);\n    }\n\n    const file: FileMetadata = {\n      uri,\n      type,\n      ...(checksum && { checksum }),\n      ...(is_default_file !== undefined && { is_default_file }),\n      ...(metadata && { metadata }),\n      ...(metadata_uri && { metadata_uri }),\n    };\n\n    if (!this.metadataObject.files) {\n      this.metadataObject.files = [];\n    }\n\n    this.metadataObject.files.push(file);\n    return this;\n  }\n\n  addProperty({ key, value }: { key: string; value: string | number | boolean | object }): Hip412MetadataBuilder {\n    if (!this.metadataObject.properties) {\n      this.metadataObject.properties = {};\n    }\n\n    this.metadataObject.properties[key] = value;\n    return this;\n  }\n\n  setLocalization({ uri, default: defaultLocale, locales }: Localization): Hip412MetadataBuilder {\n    if (this.metadataObject.localization) {\n      throw new Error(dictionary.errors.metadataBuilder.localizationAlreadySet);\n    }\n\n    if (!uri || !defaultLocale || !locales || locales.length === 0) {\n      throw new Error(dictionary.errors.metadataBuilder.localizatonFieldsMissing);\n    }\n\n    this.metadataObject.localization = {\n      uri,\n      default: defaultLocale,\n      locales,\n    };\n\n    return this;\n  }\n\n  build(): Hip412MetadataBuilderResult {\n    const validationResult = TokenMetadataValidator.validateSingleMetadataObject(this.metadataObject);\n    return { validationResult, metadata: this.metadataObject };\n  }\n}\n"],"mappings":"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","ignoreList":[]}