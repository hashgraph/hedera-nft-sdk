{"version":3,"file":"aws-service.test.js","names":["_awsService","require","_clientS","_libStorage","_aws","_buffer","jest","mock","describe","awsAccessKeyId","awsSecretAccessKey","awsS3Region","awsS3Bucket","awsService","beforeEach","S3Client","mockClear","Upload","AWSService","it","mockFile","Blob","Uint8Array","mockImplementation","done","fn","mockResolvedValue","AWS_RES_DONE","result","uploadFile","expect","toEqual","mockRejectedValue","Error","rejects","toThrow"],"sources":["../../../../../src/test/unit/storage-providers/aws-service.test.ts"],"sourcesContent":["/*-\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2024 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { AWSService } from '../../../services/file-storages/aws/aws-service';\nimport { S3Client } from '@aws-sdk/client-s3';\nimport { Upload } from '@aws-sdk/lib-storage';\nimport { AWS_RES_DONE } from '../../__mocks__/aws';\nimport { Blob } from 'buffer';\n\njest.mock('@aws-sdk/client-s3');\njest.mock('@aws-sdk/lib-storage');\n\ndescribe('AWSService', () => {\n  const awsAccessKeyId = 'myAwsAccessKeyId';\n  const awsSecretAccessKey = 'myAwsSecretAccessKey';\n  const awsS3Region = 'myAwsS3Region';\n  const awsS3Bucket = 'myAwsS3Bucket';\n\n  let awsService: AWSService;\n\n  beforeEach(() => {\n    (S3Client as jest.Mock).mockClear();\n    (Upload as unknown as jest.Mock).mockClear();\n\n    awsService = new AWSService(awsAccessKeyId, awsSecretAccessKey, awsS3Region, awsS3Bucket);\n  });\n\n  it('should upload a file successfully', async () => {\n    const mockFile = new Blob([new Uint8Array([1, 2, 3])]);\n\n    (Upload as unknown as jest.Mock).mockImplementation(() => ({\n      done: jest.fn().mockResolvedValue(AWS_RES_DONE),\n    }));\n\n    const result = await awsService.uploadFile(mockFile);\n\n    expect(result).toEqual('https://hederatest.s3.eu-central-1.amazonaws.com/1708599289764.jpg');\n  });\n\n  it('should throw an error when upload fails', async () => {\n    const mockFile = new Blob([new Uint8Array([1, 2, 3])]);\n\n    (Upload as unknown as jest.Mock).mockImplementation(() => ({\n      done: jest.fn().mockRejectedValue(new Error('Upload failed')),\n    }));\n\n    await expect(awsService.uploadFile(mockFile)).rejects.toThrow('Upload failed');\n  });\n});\n"],"mappings":";;AAmBA,IAAAA,WAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AACA,IAAAE,WAAA,GAAAF,OAAA;AACA,IAAAG,IAAA,GAAAH,OAAA;AACA,IAAAI,OAAA,GAAAJ,OAAA;AAvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAOAK,IAAI,CAACC,IAAI,CAAC,oBAAoB,CAAC;AAC/BD,IAAI,CAACC,IAAI,CAAC,sBAAsB,CAAC;AAEjCC,QAAQ,CAAC,YAAY,EAAE,MAAM;EAC3B,MAAMC,cAAc,GAAG,kBAAkB;EACzC,MAAMC,kBAAkB,GAAG,sBAAsB;EACjD,MAAMC,WAAW,GAAG,eAAe;EACnC,MAAMC,WAAW,GAAG,eAAe;EAEnC,IAAIC,UAAsB;EAE1BC,UAAU,CAAC,MAAM;IACdC,iBAAQ,CAAeC,SAAS,CAAC,CAAC;IAClCC,kBAAM,CAA0BD,SAAS,CAAC,CAAC;IAE5CH,UAAU,GAAG,IAAIK,sBAAU,CAACT,cAAc,EAAEC,kBAAkB,EAAEC,WAAW,EAAEC,WAAW,CAAC;EAC3F,CAAC,CAAC;EAEFO,EAAE,CAAC,mCAAmC,EAAE,YAAY;IAClD,MAAMC,QAAQ,GAAG,IAAIC,YAAI,CAAC,CAAC,IAAIC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAErDL,kBAAM,CAA0BM,kBAAkB,CAAC,OAAO;MACzDC,IAAI,EAAElB,IAAI,CAACmB,EAAE,CAAC,CAAC,CAACC,iBAAiB,CAACC,iBAAY;IAChD,CAAC,CAAC,CAAC;IAEH,MAAMC,MAAM,GAAG,MAAMf,UAAU,CAACgB,UAAU,CAACT,QAAQ,CAAC;IAEpDU,MAAM,CAACF,MAAM,CAAC,CAACG,OAAO,CAAC,oEAAoE,CAAC;EAC9F,CAAC,CAAC;EAEFZ,EAAE,CAAC,yCAAyC,EAAE,YAAY;IACxD,MAAMC,QAAQ,GAAG,IAAIC,YAAI,CAAC,CAAC,IAAIC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAErDL,kBAAM,CAA0BM,kBAAkB,CAAC,OAAO;MACzDC,IAAI,EAAElB,IAAI,CAACmB,EAAE,CAAC,CAAC,CAACO,iBAAiB,CAAC,IAAIC,KAAK,CAAC,eAAe,CAAC;IAC9D,CAAC,CAAC,CAAC;IAEH,MAAMH,MAAM,CAACjB,UAAU,CAACgB,UAAU,CAACT,QAAQ,CAAC,CAAC,CAACc,OAAO,CAACC,OAAO,CAAC,eAAe,CAAC;EAChF,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}