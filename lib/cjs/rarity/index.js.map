{"version":3,"file":"index.js","names":["_files","require","_getNftMetadatasFromCollection","_dictionary","calculateRarity","dir","filenames","getJSONFilesForDir","files","readFiles","attributesMap","getAttributeMap","normalizedRarities","normalizedCount","forEach","file","traitRarities","filedata","attributes","NFTAttribute","display_type","push","trait","trait_type","value","rarity","attributeConfigObject","find","attribute","Error","dictionary","errors","attributeTypeNotFound","NFTsWithTrait","values","valueObject","mostCommonTrait","reduce","prev","current","count","traitRarity","totalRarity","attributeContributions","map","contribution","toFixed","NFT","filename","exports","attributeNotFoundInFile","matchedAttributeIndex","findIndex","attributeObject","matchedValueIndex","toString","getAttributeMapData","metadataArray","metadata","attributeNotFoundInObject","JSON","stringify","Array","isArray","calculateRarityFromData","calculateTraitOccurrenceFromData","traitOccurrences","traitOccurrence","occurence","length","calculateRarityFromOnChainData","network","tokenId","ipfsGateway","limit","arguments","undefined","metadataObjects","getNftMetadataFromCollection","filteredArray","obj","filter","item"],"sources":["../../../src/rarity/index.ts"],"sourcesContent":["/**\n * Hedera NFT SDK\n *\n * Copyright (C) 2023 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { readFiles, getJSONFilesForDir } from '../helpers/files';\nimport { RarityResult, AttributeConfig, ValueObject, NFTFile, TraitOccurrence } from '../types/rarity';\nimport { Attribute } from '../types/validator';\nimport { NFTMetadata } from '../types/nft-metadata';\nimport { NetworkName } from '@hashgraph/sdk/lib/client/Client';\nimport { getNftMetadataFromCollection } from '../helpers/get-nft-metadatas-from-collection';\nimport { dictionary } from '../utils/constants/dictionary';\nimport { MetadataObject } from '../types/csv';\n\n/**\n *\n * @param {string} dir Absolute path to folder with metadata files for rarity calculation\n * @return {RarityResult[]} Array of objects with rarity information for each NFT\n */\nconst calculateRarity = (dir: string): RarityResult[] => {\n  const filenames = getJSONFilesForDir(dir);\n  const files = readFiles(dir, filenames);\n\n  const attributesMap = getAttributeMap(files);\n\n  const normalizedRarities: RarityResult[] = [];\n  let normalizedCount = 1;\n  files.forEach((file) => {\n    const traitRarities: { trait: string; value: string | number; rarity: number }[] = [];\n\n    file.filedata.attributes.forEach((NFTAttribute: Attribute) => {\n      // Skip special types of attributes in the rarity calculation (Openrarity specification)\n      if (\n        NFTAttribute.display_type == 'percentage' ||\n        NFTAttribute.display_type == 'boost' ||\n        NFTAttribute.display_type == 'color' ||\n        NFTAttribute.display_type == 'datetime' ||\n        NFTAttribute.display_type == 'boolean'\n      ) {\n        return traitRarities.push({\n          trait: NFTAttribute.trait_type,\n          value: NFTAttribute.value,\n          rarity: 0,\n        });\n      }\n\n      const attributeConfigObject: AttributeConfig | undefined = attributesMap.find(\n        (attribute) => attribute.trait_type === NFTAttribute.trait_type\n      );\n\n      if (!attributeConfigObject) throw new Error(dictionary.errors.rarity.attributeTypeNotFound(NFTAttribute.trait_type));\n      const NFTsWithTrait: ValueObject | undefined = attributeConfigObject.values.find(\n        (valueObject) => valueObject.value === NFTAttribute.value\n      );\n      const mostCommonTrait = attributeConfigObject.values.reduce((prev, current) => (prev.count > current.count ? prev : current));\n      const traitRarity = 1 / (NFTsWithTrait?.count! / mostCommonTrait.count);\n\n      return traitRarities.push({\n        trait: NFTAttribute.trait_type,\n        value: NFTAttribute.value,\n        rarity: traitRarity,\n      });\n    });\n\n    const totalRarity = traitRarities.reduce((prev, current) => prev + current.rarity, 0);\n    const attributeContributions = traitRarities.map((traitRarity) => ({\n      trait: traitRarity.trait,\n      value: traitRarity.value,\n      contribution: ((traitRarity.rarity / totalRarity) * 100).toFixed(2),\n    }));\n\n    normalizedRarities.push({\n      attributeContributions: attributeContributions,\n      totalRarity: totalRarity.toFixed(2),\n      NFT: normalizedCount,\n      filename: file.filename,\n    });\n    normalizedCount++;\n  });\n\n  return normalizedRarities;\n};\n\n/**\n * @param {NFTFile[]} files Array of NFTFile objects\n * @return {AttributeConfig[]} Array of objects with attribute information\n * */\nconst getAttributeMap = (files: NFTFile[]): AttributeConfig[] => {\n  const attributesMap: AttributeConfig[] = [];\n  files.forEach((file) => {\n    if (!file.filedata.attributes) throw new Error(dictionary.errors.rarity.attributeNotFoundInFile(file.filename));\n\n    file.filedata.attributes.forEach((attribute: Attribute) => {\n      const matchedAttributeIndex = attributesMap.findIndex((attributeObject) => attribute.trait_type === attributeObject.trait_type);\n      if (matchedAttributeIndex !== -1) {\n        const matchedValueIndex = attributesMap[matchedAttributeIndex].values.findIndex(\n          (valueObject) => valueObject.value === attribute.value\n        );\n\n        if (matchedValueIndex !== -1) {\n          attributesMap[matchedAttributeIndex].values[matchedValueIndex].count++;\n        } else {\n          attributesMap[matchedAttributeIndex].values.push({\n            value: attribute.value.toString(),\n            count: 1,\n          });\n        }\n      } else {\n        attributesMap.push({\n          trait_type: attribute.trait_type,\n          values: [{ value: attribute.value.toString(), count: 1 }],\n        });\n      }\n    });\n  });\n\n  return attributesMap;\n};\n\n/**\n * @return {AttributeConfig[]} Array of objects with attribute information\n * @param metadataArray\n * */\nconst getAttributeMapData = (metadataArray: MetadataObject[] | NFTMetadata[]): AttributeConfig[] => {\n  const attributesMap: AttributeConfig[] = [];\n  metadataArray.forEach((metadata) => {\n    if (!metadata.attributes) throw new Error(dictionary.errors.rarity.attributeNotFoundInObject(JSON.stringify(metadata)));\n    if (Array.isArray(metadata.attributes)) {\n      metadata.attributes.forEach((attribute) => {\n        const matchedAttributeIndex = attributesMap.findIndex((attributeObject) => attribute.trait_type === attributeObject.trait_type);\n        if (matchedAttributeIndex !== -1) {\n          const matchedValueIndex = attributesMap[matchedAttributeIndex].values.findIndex(\n            (valueObject) => valueObject.value === attribute.value\n          );\n\n          if (matchedValueIndex !== -1) {\n            attributesMap[matchedAttributeIndex].values[matchedValueIndex].count++;\n          } else {\n            attributesMap[matchedAttributeIndex].values.push({\n              value: attribute.value?.toString() || '',\n              count: 1,\n            });\n          }\n        } else {\n          attributesMap.push(<AttributeConfig>{\n            trait_type: attribute.trait_type,\n            values: [{ value: attribute.value?.toString(), count: 1 }],\n          });\n        }\n      });\n    }\n  });\n\n  return attributesMap;\n};\n\n/**\n *\n * @param {Array<Object>} metadataArray Array of JSON objects for rarity calculation\n * @return {RarityResult[]} Array of objects with rarity information for each NFT\n */\nconst calculateRarityFromData = (metadataArray: MetadataObject[] | NFTMetadata[]): RarityResult[] => {\n  const attributesMap = getAttributeMapData(metadataArray);\n\n  const normalizedRarities: RarityResult[] = [];\n  let normalizedCount = 1;\n  metadataArray.forEach((metadata) => {\n    const traitRarities: { trait: string; value: string | number; rarity: number }[] = [];\n    if (Array.isArray(metadata.attributes)) {\n      metadata.attributes?.forEach((NFTAttribute) => {\n        const attributeConfigObject: AttributeConfig | undefined = attributesMap.find(\n          (attribute) => attribute.trait_type === NFTAttribute.trait_type\n        );\n\n        if (!attributeConfigObject)\n          throw new Error(dictionary.errors.rarity.attributeTypeNotFound(NFTAttribute.trait_type?.toString() || ''));\n        const NFTsWithTrait: ValueObject | undefined = attributeConfigObject.values.find(\n          (valueObject) => valueObject.value === NFTAttribute.value\n        );\n        const mostCommonTrait = attributeConfigObject.values.reduce((prev, current) => (prev.count > current.count ? prev : current));\n        const traitRarity = 1 / (NFTsWithTrait?.count! / mostCommonTrait.count);\n\n        traitRarities.push({\n          trait: NFTAttribute.trait_type?.toString() || '',\n          value: NFTAttribute.value?.toString() || '',\n          rarity: traitRarity,\n        });\n      });\n    }\n\n    const totalRarity = traitRarities.reduce((prev, current) => prev + current.rarity, 0);\n    const attributeContributions = traitRarities.map((traitRarity) => ({\n      trait: traitRarity.trait,\n      value: traitRarity.value,\n      contribution: ((traitRarity.rarity / totalRarity) * 100).toFixed(2),\n    }));\n\n    normalizedRarities.push({\n      attributeContributions: attributeContributions,\n      totalRarity: totalRarity.toFixed(2),\n      NFT: normalizedCount,\n    });\n    normalizedCount++;\n  });\n\n  return normalizedRarities;\n};\n\nconst calculateTraitOccurrenceFromData = (metadataArray: MetadataObject[]): TraitOccurrence[] => {\n  const attributesMap = getAttributeMapData(metadataArray);\n\n  const traitOccurrences: TraitOccurrence[] = [];\n\n  attributesMap.forEach((attribute) => {\n    const traitOccurrence: TraitOccurrence = {\n      trait: attribute.trait_type,\n      values: [],\n    };\n\n    attribute.values.forEach((value) => {\n      traitOccurrence.values.push({\n        value: value.value,\n        occurence: ((value.count / metadataArray.length) * 100).toFixed(2),\n      });\n    });\n\n    traitOccurrences.push(traitOccurrence);\n  });\n\n  return traitOccurrences;\n};\n\nconst calculateRarityFromOnChainData = async (network: NetworkName, tokenId: string, ipfsGateway?: string, limit: number = 100) => {\n  const metadataObjects = await getNftMetadataFromCollection(network, tokenId, limit, ipfsGateway);\n\n  const filteredArray = metadataObjects.map((obj) => obj.metadata).filter((item): item is NFTMetadata => item !== undefined);\n\n  return calculateRarityFromData(filteredArray);\n};\n\nexport { calculateRarity, calculateRarityFromData, calculateTraitOccurrenceFromData, calculateRarityFromOnChainData };\n"],"mappings":"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","ignoreList":[]}