{"version":3,"file":"index.js","names":["_validators","require","_HIP","_interopRequireDefault","_HIP2","obj","__esModule","default","defaultSchemaVersion","exports","Validator","constructor","schemas","arguments","length","undefined","schemaMap","Map","set","token_metadata_1_0_0","token_metadata_2_0_0","forEach","schema","tag","schemaObject","getSchema","version","validVersion","has","get","validate","instance","schemaVersion","Error","schemaProblems","schemaValidator","errors","warnings","attributesValidator","localizationValidator","SHA256Validator"],"sources":["../../../src/validator/index.ts"],"sourcesContent":["/*\n *\n * Hedera NFT SDK\n *\n * Copyright (C) 2023 Hedera Hashgraph, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\nimport { schemaValidator, attributesValidator, localizationValidator, SHA256Validator } from './validators';\n\nimport token_metadata_1_0_0 from './schemas/HIP10@1.0.0';\nimport token_metadata_2_0_0 from './schemas/HIP412@2.0.0';\nconst defaultSchemaVersion = '2.0.0';\n\nimport { Schema, Instance } from '../types/validator';\n\nclass Validator {\n  private schemaMap: Map<string, Object>;\n\n  constructor(schemas: Schema[] = []) {\n    this.schemaMap = new Map();\n    this.schemaMap.set('1.0.0', token_metadata_1_0_0);\n    this.schemaMap.set('2.0.0', token_metadata_2_0_0);\n\n    schemas.forEach((schema) => {\n      this.schemaMap.set(schema.tag, schema.schemaObject);\n    });\n  }\n\n  getSchema(version: string) {\n    const validVersion = this.schemaMap.has(version);\n    if (validVersion) {\n      return this.schemaMap.get(version);\n    }\n\n    return this.schemaMap.get(defaultSchemaVersion);\n  }\n\n  validate(instance: Instance, schemaVersion: string = defaultSchemaVersion) {\n    const schema = this.getSchema(schemaVersion);\n    if (!schema) throw new Error('Invalid schema version');\n\n    const schemaProblems = schemaValidator(instance, schema);\n\n    // If there are schema problems, return them and stop the validation process\n    if (schemaProblems.errors.length > 0) {\n      return {\n        errors: [...schemaProblems.errors],\n        warnings: [...schemaProblems.warnings],\n      };\n    }\n\n    const errors = [...attributesValidator(instance), ...localizationValidator(instance), ...SHA256Validator(instance)];\n\n    return {\n      errors,\n      warnings: [...schemaProblems.warnings],\n    };\n  }\n}\n\nexport { Validator, defaultSchemaVersion };\n"],"mappings":";;;;;;AAmBA,IAAAA,WAAA,GAAAC,OAAA;AAEA,IAAAC,IAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,KAAA,GAAAD,sBAAA,CAAAF,OAAA;AAA0D,SAAAE,uBAAAE,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAtB1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKA,MAAMG,oBAAoB,GAAAC,OAAA,CAAAD,oBAAA,GAAG,OAAO;AAIpC,MAAME,SAAS,CAAC;EAGdC,WAAWA,CAAA,EAAyB;IAAA,IAAxBC,OAAiB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;IAChC,IAAI,CAACG,SAAS,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC1B,IAAI,CAACD,SAAS,CAACE,GAAG,CAAC,OAAO,EAAEC,YAAoB,CAAC;IACjD,IAAI,CAACH,SAAS,CAACE,GAAG,CAAC,OAAO,EAAEE,aAAoB,CAAC;IAEjDR,OAAO,CAACS,OAAO,CAAEC,MAAM,IAAK;MAC1B,IAAI,CAACN,SAAS,CAACE,GAAG,CAACI,MAAM,CAACC,GAAG,EAAED,MAAM,CAACE,YAAY,CAAC;IACrD,CAAC,CAAC;EACJ;EAEAC,SAASA,CAACC,OAAe,EAAE;IACzB,MAAMC,YAAY,GAAG,IAAI,CAACX,SAAS,CAACY,GAAG,CAACF,OAAO,CAAC;IAChD,IAAIC,YAAY,EAAE;MAChB,OAAO,IAAI,CAACX,SAAS,CAACa,GAAG,CAACH,OAAO,CAAC;IACpC;IAEA,OAAO,IAAI,CAACV,SAAS,CAACa,GAAG,CAACrB,oBAAoB,CAAC;EACjD;EAEAsB,QAAQA,CAACC,QAAkB,EAAgD;IAAA,IAA9CC,aAAqB,GAAAnB,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGL,oBAAoB;IACvE,MAAMc,MAAM,GAAG,IAAI,CAACG,SAAS,CAACO,aAAa,CAAC;IAC5C,IAAI,CAACV,MAAM,EAAE,MAAM,IAAIW,KAAK,CAAC,wBAAwB,CAAC;IAEtD,MAAMC,cAAc,GAAG,IAAAC,2BAAe,EAACJ,QAAQ,EAAET,MAAM,CAAC;;IAExD;IACA,IAAIY,cAAc,CAACE,MAAM,CAACtB,MAAM,GAAG,CAAC,EAAE;MACpC,OAAO;QACLsB,MAAM,EAAE,CAAC,GAAGF,cAAc,CAACE,MAAM,CAAC;QAClCC,QAAQ,EAAE,CAAC,GAAGH,cAAc,CAACG,QAAQ;MACvC,CAAC;IACH;IAEA,MAAMD,MAAM,GAAG,CAAC,GAAG,IAAAE,+BAAmB,EAACP,QAAQ,CAAC,EAAE,GAAG,IAAAQ,iCAAqB,EAACR,QAAQ,CAAC,EAAE,GAAG,IAAAS,2BAAe,EAACT,QAAQ,CAAC,CAAC;IAEnH,OAAO;MACLK,MAAM;MACNC,QAAQ,EAAE,CAAC,GAAGH,cAAc,CAACG,QAAQ;IACvC,CAAC;EACH;AACF;AAAC5B,OAAA,CAAAC,SAAA,GAAAA,SAAA","ignoreList":[]}